\exercise

Show how to synchronize via rsync the new file $f_{old} = \text{\tt
“bacaddabbb”}$ (on the server) using the old file $f_{new} = \text{\tt
“acabbbdab”}$ (on the client) and blocks of size 3 chars.

\solution

The client starts computing the hashes of $f_{old}$ divided by blocks
of 3 chars:
%
\begin{align*}
  \underbracket{\vphantom{\tt g}\texttt{b a c}}_{H_1}\
  \underbracket{\vphantom{\tt g}\texttt{a d d}}_{H_2}\
  \underbracket{\vphantom{\tt g}\texttt{a b b}}_{H_3}\
  \underbracket{\vphantom{\tt g}\texttt{b \$}}_{H_4}
\end{align*}
The client sends the hashcodes to the server, which compares them to the ones
produced by the rolling hash on $f_{new}$:
%
\begin{align*}
  \texttt{a c}\
  \underbracket{\vphantom{\tt g}\texttt{a b b}}_{H_3}\ \texttt{b d a}\
  \underbracket{\vphantom{\tt g}\texttt{b \$}}_{H_4}
\end{align*}
%
Then server the sends: "{\tt a c}", $H_3$, "{\tt b d a}", $H_4$.
