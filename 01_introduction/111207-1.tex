\exercise

Given the inverted lists of two terms $t_1$ and $t_2$, write the pseudo-code of the
algorithm that implements $t_1$ AND (NOT $t_2$). Discuss and compute its time
complexity as a function of the lengths of the two posting lists.  \emph{(Hint:
do not create explicitly (NOT $t_2$))}

\solution

Given $m = |t_1|$ and $n = |t_2|$, the following algorithm takes
$\mathcal{O}(m+n)$ time in the worst case, while $\mathcal{O}(m)$ in the best
case (i.e., when $\max\{t_1\} < \min\{t_2\}$). This algorithm performs a scan of
both lists, so the I/O complexity is $\mathcal{O}(\frac{m}{B}+\frac{n}{B})$.
Both complexities may be improved using skip pointers.

\begin{algorithm}[H]
\caption{}\label{alg:andnot}
\begin{algorithmic}[1]
\Function{AndNot}{$p_1$, $p_2$}
\State $res \gets \langle\rangle$
\While{$p_1 \neq nil$}
\If{$p_2 = nil$}
\State $res.\text{\scshape appendAll}(p_1)$
\ElsIf{$p_1.id < p_2.id$}
\State $res.\text{\scshape append}(p_1.id)$
\State $p_1 \gets p_1.next$
\ElsIf{$p_1.id = p_2.id$}
\State $p_1 \gets p_1.next$
\State $p_2 \gets p_2.next$
\Else
\State $p_2 \gets p_2.next$
\EndIf
\EndWhile
\State \Return $res$
\EndFunction
\end{algorithmic}
\end{algorithm}
