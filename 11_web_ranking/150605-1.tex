\exercise

Let us given a graph $G$ of directed edges $E=\{(1,2), (2,1), (1,4), (3,1)\}$.
Simulate the execution of two steps of PageRank, starting with nodes with $PR=1$
(unnormalized), and assuming a teleportation step which favors node 3.

\solution

We want the principal left eigenvector $r$ of
%
$$P = \alpha\Pi + (1-\alpha) er_0,$$
%
were $r_0 = \begin{pmatrix}\sfrac{1}{4}&\sfrac{1}{4}&\sfrac{1}{4}&\sfrac{1}{4}
\end{pmatrix}$, $e=\begin{pmatrix}1&1&1&1\end{pmatrix}^\top$, and
%
\begin{equation*}
  \Pi_{ij} =
  \begin{cases*}
    \sfrac{1}{\left|\left\{(i,k)\;:\;(i,k)\in E\right\}\right|}
      & if $(i,j) \in E$ \\
    \sfrac{1}{N} & if $i$ is a sink node \\
    0 & otherwise.
  \end{cases*}
\end{equation*}

We choose $\alpha=\sfrac{1}{3}$ and compute
%
\begin{align*}
  P &=  \alpha\Pi + (1-\alpha) er_0 \\
    &=
        \frac{1}{3}
        \begin{pmatrix}
          0&\sfrac{1}{2}&0&\sfrac{1}{2} \\
          1&0&0&0 \\
          1&0&0&0 \\
          \sfrac{1}{4}&\sfrac{1}{4}&\sfrac{1}{4}&\sfrac{1}{4}
        \end{pmatrix}
        +
        \left(1-\frac{1}{3}\right)
        \begin{pmatrix}
          \sfrac{1}{4}&\sfrac{1}{4}&\sfrac{1}{4}&\sfrac{1}{4} \\
          \sfrac{1}{4}&\sfrac{1}{4}&\sfrac{1}{4}&\sfrac{1}{4} \\
          \sfrac{1}{4}&\sfrac{1}{4}&\sfrac{1}{4}&\sfrac{1}{4} \\
          \sfrac{1}{4}&\sfrac{1}{4}&\sfrac{1}{4}&\sfrac{1}{4}
        \end{pmatrix} \\
    &=
        \begin{pmatrix}
          \sfrac{1}{6}&\sfrac{1}{3}&\sfrac{1}{6}&\sfrac{1}{3} \\
          \sfrac{1}{2}&\sfrac{1}{6}&\sfrac{1}{6}&\sfrac{1}{6} \\
          \sfrac{1}{2}&\sfrac{1}{6}&\sfrac{1}{6}&\sfrac{1}{6} \\
          \sfrac{1}{4}&\sfrac{1}{4}&\sfrac{1}{4}&\sfrac{1}{4}
        \end{pmatrix}.
\end{align*}

We then perform the power iteration for two steps:
%
\begin{alignat*}{2}
  r_0 P &= 
    \begin{pmatrix}
      \sfrac{17}{48}&\sfrac{11}{48}&\sfrac{9}{48}&\sfrac{11}{48}
    \end{pmatrix} &&= r_1 \\
  r_1 P &= 
    \begin{pmatrix}
      \sfrac{187}{576}&\sfrac{141}{576}&\sfrac{107}{576}&\sfrac{141}{576}
    \end{pmatrix} &&= r_2.
\end{alignat*}